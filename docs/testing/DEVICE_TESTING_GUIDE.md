# Device Testing Guide - Motion Detection

React Native 모션 감지 애플리케이션의 실제 디바이스 테스트 가이드입니다.

## 📋 사전 준비

### Android 테스트 디바이스 요구사항
- **OS**: Android 10 (API 29) 이상 권장
- **센서**: GPS, Accelerometer, Gyroscope 필수
- **개발자 모드**: 활성화 필요
- **USB 디버깅**: 활성화 필요
- **배터리**: 완전 충전 상태 (성능 테스트용)

### iOS 테스트 디바이스 요구사항
- **OS**: iOS 11.0 이상
- **센서**: GPS, Motion sensors 필수
- **개발자 인증서**: 설치 완료
- **배터리**: 완전 충전 상태 (성능 테스트용)

### 테스트 환경 준비
```bash
# 빌드 및 설치 (Android)
cd android && ./gradlew clean
cd .. && npx react-native run-android

# 빌드 및 설치 (iOS)
cd ios && pod install
cd .. && npx react-native run-ios
```

---

## 🧪 테스트 시나리오

### 1. 기본 권한 플로우 테스트

#### 1.1 위치 권한 요청 (Android)
- [ ] 앱 최초 실행
- [ ] "걷기/뛰기 감지" 탭 선택
- [ ] "모션 감지 시작" 버튼 클릭
- [ ] **예상 결과**: 위치 권한 요청 다이얼로그 표시
- [ ] "허용" 선택
- [ ] **예상 결과**: 모션 감지 시작

**관찰 사항**:
```
- 권한 다이얼로그 표시: [Yes/No]
- 권한 허용 후 감지 시작: [Yes/No]
- 오류 메시지: [None/내용]
```

#### 1.2 모션 권한 요청 (Android)
- [ ] Activity Recognition 권한 요청 다이얼로그 표시
- [ ] "허용" 선택
- [ ] **예상 결과**: 걷기/뛰기 분류 기능 활성화

**관찰 사항**:
```
- 모션 권한 요청: [Yes/No]
- 권한 허용 후 동작: [정상/비정상]
```

#### 1.3 백그라운드 위치 권한 (Android 10+)
- [ ] "항상 허용" 옵션 표시 확인
- [ ] "항상 허용" 선택
- [ ] **예상 결과**: 백그라운드 감지 활성화

**관찰 사항**:
```
- "항상 허용" 옵션: [표시됨/표시 안됨]
- 백그라운드 권한 상태: [허용됨/거부됨]
```

#### 1.4 iOS 위치 권한
- [ ] "앱 사용 중에만 허용" 선택
- [ ] **예상 결과**: 포그라운드 감지 동작
- [ ] 설정 → "항상 허용"으로 변경
- [ ] **예상 결과**: 백그라운드 감지 동작

**관찰 사항**:
```
- 권한 다이얼로그 텍스트: [적절함/부적절함]
- "항상 허용" 업그레이드: [Yes/No]
```

---

### 2. 걷기 감지 테스트

#### 2.1 기본 걷기 감지
**테스트 절차**:
1. [ ] "걷기/뛰기 감지" 탭 선택
2. [ ] "모션 감지 시작" 버튼 클릭
3. [ ] 디바이스를 들고 평상시 속도로 걷기 (최소 2분)
4. [ ] UI 상태 확인

**예상 결과**:
- [ ] 🚶 걷기 아이콘 표시
- [ ] "걷기 감지됨" 텍스트 표시
- [ ] 통계: walkingTime 증가 확인
- [ ] 로그: 걷기 활동 기록 확인

**측정값**:
```
- 감지까지 소요 시간: ___ 초
- 감지 정확도: [높음/중간/낮음]
- 걷기 시간 누적: ___ 초
- 생성된 로그 수: ___ 개
```

#### 2.2 느린 걷기 감지
**테스트 절차**:
1. [ ] 모션 감지 시작
2. [ ] 매우 천천히 걷기 (최소 1분)

**예상 결과**:
- [ ] 느린 걷기도 감지됨
- 또는
- [ ] "inactive" 상태 유지 (정상 - 신뢰도 임계값 70% 미만)

**측정값**:
```
- 감지 여부: [Yes/No]
- 감지 시간: ___ 초
- 비고: ___
```

#### 2.3 빠른 걷기 감지
**테스트 절차**:
1. [ ] 모션 감지 시작
2. [ ] 빠르게 걷기 (최소 1분)

**예상 결과**:
- [ ] 걷기로 감지됨
- 또는
- [ ] 뛰기로 잘못 감지됨 (경계 케이스)

**측정값**:
```
- 감지된 활동: [걷기/뛰기/inactive]
- 정확도: [높음/중간/낮음]
```

---

### 3. 뛰기 감지 테스트

#### 3.1 기본 뛰기 감지
**테스트 절차**:
1. [ ] "걷기/뛰기 감지" 탭 선택
2. [ ] "모션 감지 시작" 버튼 클릭
3. [ ] 디바이스를 들고 조깅 속도로 뛰기 (최소 1분)
4. [ ] UI 상태 확인

**예상 결과**:
- [ ] 🏃 뛰기 아이콘 표시
- [ ] "뛰기 감지됨" 텍스트 표시
- [ ] 통계: runningTime 증가 확인
- [ ] 로그: 뛰기 활동 기록 확인

**측정값**:
```
- 감지까지 소요 시간: ___ 초
- 감지 정확도: [높음/중간/낮음]
- 뛰기 시간 누적: ___ 초
- 생성된 로그 수: ___ 개
```

#### 3.2 전력 질주 감지
**테스트 절차**:
1. [ ] 모션 감지 시작
2. [ ] 빠르게 달리기 (최소 30초)

**예상 결과**:
- [ ] 뛰기로 정확히 감지됨

**측정값**:
```
- 감지 여부: [Yes/No]
- 감지 정확도: [높음/중간/낮음]
```

---

### 4. 활동 전환 테스트

#### 4.1 걷기 → 뛰기 전환
**테스트 절차**:
1. [ ] 모션 감지 시작
2. [ ] 걷기 시작 (30초)
3. [ ] 걷기 → 뛰기 전환
4. [ ] 뛰기 계속 (30초)
5. [ ] UI 변화 관찰

**예상 결과**:
- [ ] 걷기 세션 로그 생성
- [ ] UI 아이콘 변경: 🚶 → 🏃
- [ ] 통계 업데이트: walkingTime + runningTime

**측정값**:
```
- 전환 감지 시간: ___ 초
- 걷기 로그 duration: ___ 초
- UI 업데이트 지연: [즉시/<2초/>2초]
```

#### 4.2 뛰기 → 정지 전환
**테스트 절차**:
1. [ ] 모션 감지 시작
2. [ ] 뛰기 시작 (1분)
3. [ ] 완전히 정지
4. [ ] UI 변화 관찰

**예상 결과**:
- [ ] 뛰기 세션 로그 생성
- [ ] UI 상태: "inactive"
- [ ] 통계 업데이트 확인

**측정값**:
```
- inactive 전환 시간: ___ 초
- 뛰기 로그 duration: ___ 초
- 통계 정확도: [정확함/부정확함]
```

#### 4.3 복합 전환 시퀀스
**테스트 절차**:
1. [ ] 모션 감지 시작
2. [ ] 걷기 (1분) → 정지 (30초) → 뛰기 (1분) → 정지 (30초) → 걷기 (1분)
3. [ ] 모션 감지 중지

**예상 결과**:
- [ ] 총 3개의 활동 로그 생성 (걷기 2개, 뛰기 1개)
- [ ] 통계 정확히 합산됨

**측정값**:
```
- 생성된 로그 수: ___ 개 (예상: 3개)
- 걷기 총 시간: ___ 초 (예상: ~120초)
- 뛰기 총 시간: ___ 초 (예상: ~60초)
```

---

### 5. 백그라운드 모드 테스트

#### 5.1 백그라운드 걷기 감지
**테스트 절차**:
1. [ ] "걷기/뛰기 감지" 탭에서 "모션 감지 시작"
2. [ ] 걷기 시작 (30초) - 감지 확인
3. [ ] 홈 버튼 클릭 (앱 백그라운드로 전환)
4. [ ] 계속 걷기 (2분)
5. [ ] 앱 복귀

**예상 결과** (Android):
- [ ] 알림 영역에 포그라운드 서비스 알림 표시
- [ ] 백그라운드에서도 위치/모션 감지 지속
- [ ] 앱 복귀 시 통계 정확히 업데이트됨

**예상 결과** (iOS):
- [ ] 백그라운드 위치 업데이트 지속
- [ ] 앱 복귀 시 통계 정확히 업데이트됨

**측정값**:
```
- 백그라운드 감지 지속: [Yes/No]
- 알림 표시 (Android): [Yes/No]
- 통계 정확도: [정확함/부정확함]
- 백그라운드 시간: ___ 초
- 로그 생성: [정상/누락]
```

#### 5.2 앱 종료 후 재시작
**테스트 절차**:
1. [ ] 모션 감지 시작 후 걷기 (1분)
2. [ ] 앱 강제 종료 (멀티태스킹에서 스와이프)
3. [ ] 앱 재시작
4. [ ] 통계 및 로그 확인

**예상 결과**:
- [ ] 이전 세션 통계 복원됨
- [ ] 이전 로그 유지됨
- [ ] 감지는 중지 상태

**측정값**:
```
- 통계 복원: [Yes/No]
- 로그 복원: [Yes/No]
- 복원된 walkingTime: ___ 초
- 복원된 로그 수: ___ 개
```

---

### 6. 성능 측정 테스트

#### 6.1 배터리 소모 측정
**테스트 절차**:
1. [ ] 디바이스 완전 충전 (100%)
2. [ ] 모션 감지 시작
3. [ ] 걷기/뛰기 혼합 활동 (1시간)
4. [ ] 배터리 잔량 확인

**Android 배터리 측정**:
```bash
# 시작 전 배터리 상태
adb shell dumpsys battery

# 1시간 후 배터리 상태
adb shell dumpsys battery

# 앱 배터리 사용량
adb shell dumpsys batterystats --charged com.rngeolocation4ccapp
```

**측정값**:
```
- 시작 배터리: 100%
- 1시간 후 배터리: ____%
- 배터리 소모: ____% (목표: <5%)
- 시간당 소모율: ____% per hour
```

**iOS 배터리 측정**:
- 설정 → 배터리 → 앱별 사용량 확인

**측정값**:
```
- 1시간 사용 비율: ____%
- 평가: [우수(<3%)/양호(3-5%)/개선필요(>5%)]
```

#### 6.2 메모리 사용량 측정
**Android 메모리 측정**:
```bash
# 메모리 사용량 확인
adb shell dumpsys meminfo com.rngeolocation4ccapp

# 지속적 모니터링 (10초 간격)
while true; do
  adb shell dumpsys meminfo com.rngeolocation4ccapp | grep TOTAL
  sleep 10
done
```

**측정값**:
```
- 앱 시작 시: ___ MB
- 감지 시작 후: ___ MB
- 1시간 후: ___ MB
- 메모리 증가: ___ MB (목표: <50MB)
- 메모리 누수: [Yes/No]
```

**iOS 메모리 측정**:
- Xcode → Instruments → Activity Monitor

**측정값**:
```
- Real Memory: ___ MB
- 메모리 안정성: [안정적/불안정]
- 메모리 경고: [없음/발생]
```

#### 6.3 CPU 사용량 측정
**Android CPU 측정**:
```bash
# CPU 사용률 확인
adb shell top -n 1 | grep com.rngeolocation4ccapp
```

**측정값**:
```
- 감지 중 평균 CPU: ____%
- 평가: [낮음(<5%)/보통(5-15%)/높음(>15%)]
```

**iOS CPU 측정**:
- Xcode → Debug Navigator → CPU

**측정값**:
```
- 평균 CPU 사용률: ____%
- 피크 CPU 사용률: ____%
```

#### 6.4 네트워크 사용량 (해당 시)
**측정값**:
```
- 네트워크 데이터 사용: ___ MB
- 비고: [위치 업로드 없음 - 로컬만 사용]
```

---

### 7. 차량 하차 감지 테스트 (추후)

#### 7.1 차량 정지 감지
**테스트 절차**:
1. [ ] "차량 하차 감지" 탭 선택
2. [ ] "차량 감지 시작" 버튼 클릭
3. [ ] 차량 운전 시뮬레이션 (자동차로 이동)
4. [ ] 차량 정지 및 주차
5. [ ] 차량에서 하차 후 걷기

**예상 결과**:
- [ ] 운전 중: 차량 상태 감지
- [ ] 정지: 주차 감지
- [ ] 하차 후 걷기: 자동으로 걷기 감지 전환

**측정값**:
```
- 차량 감지: [Yes/No]
- 하차 감지: [Yes/No]
- 걷기 전환: [자동/수동 필요]
```

---

## 📊 테스트 결과 요약

### 정확도 평가

#### 걷기 감지 정확도
```
테스트 횟수: ___ 회
성공: ___ 회
실패: ___ 회
정확도: ___% (목표: >85%)
```

#### 뛰기 감지 정확도
```
테스트 횟수: ___ 회
성공: ___ 회
실패: ___ 회
정확도: ___% (목표: >80%)
```

#### 활동 전환 정확도
```
테스트 횟수: ___ 회
성공: ___ 회
실패: ___ 회
정확도: ___% (목표: >90%)
```

### 성능 평가

#### 배터리 성능
```
1시간 소모량: ____%
평가: [통과/실패] (기준: <5%)
```

#### 메모리 성능
```
최대 메모리: ___ MB
평가: [통과/실패] (기준: <100MB)
```

#### 백그라운드 성능
```
백그라운드 동작: [정상/비정상]
평가: [통과/실패]
```

---

## 🐛 발견된 이슈

### 이슈 #1
```
제목: ___
재현 단계:
1. ___
2. ___
3. ___

예상 결과: ___
실제 결과: ___
심각도: [Critical/High/Medium/Low]
플랫폼: [Android/iOS/Both]
```

### 이슈 #2
```
(동일 형식)
```

---

## ✅ 테스트 완료 체크리스트

### Android 테스트
- [ ] 권한 플로우 (위치, 모션, 백그라운드)
- [ ] 걷기 감지 (기본, 느린, 빠른)
- [ ] 뛰기 감지 (조깅, 전력질주)
- [ ] 활동 전환 (걷기↔뛰기↔정지)
- [ ] 백그라운드 모드
- [ ] 앱 재시작 후 복원
- [ ] 배터리 측정 (1시간)
- [ ] 메모리 측정
- [ ] CPU 측정

### iOS 테스트
- [ ] 권한 플로우 (위치, 모션)
- [ ] 걷기 감지
- [ ] 뛰기 감지
- [ ] 활동 전환
- [ ] 백그라운드 모드
- [ ] 앱 재시작 후 복원
- [ ] 배터리 측정
- [ ] 메모리 측정
- [ ] CPU 측정

---

## 📝 테스트 담당자 서명

```
테스트 수행자: _______________
테스트 일자: _______________
디바이스 모델: _______________
OS 버전: _______________
앱 버전: _______________

종합 평가: [통과/조건부 통과/실패]

비고:
_______________________________________________
_______________________________________________
_______________________________________________
```

---

## 📚 참고 자료

- [react-native-background-geolocation 문서](https://github.com/transistorsoft/react-native-background-geolocation)
- [PRD 문서](../prd.md)
- [Workflow Roadmap](../workflow_roadmap.md)
- [프로토타입](../prototype/index-single.html)
